{"visual":{"name":"scrollyteller","displayName":"ScrollyTeller","guid":"scrollytellerE1D30D6506E94BB5AB73806C9D68D079","visualClassName":"Visual","version":"1.0.2","description":"Enables scrollytelling with parallax effect","supportUrl":"https://github.com/deldersveld/pbiScrollyTeller","gitHubUrl":"https://github.com/deldersveld/pbiScrollyTeller"},"apiVersion":"1.7.0","author":{"name":"David Eldersveld"},"assets":{"icon":"assets/icon.png"},"externalJS":["node_modules/powerbi-visuals-utils-dataviewutils/lib/index.js"],"style":"style/visual.less","capabilities":{"dataRoles":[{"displayName":"Sequence","name":"measure","kind":"Measure"},{"displayName":"Text","name":"category","kind":"Grouping"},{"displayName":"Image URL","name":"imageUrl","kind":"Grouping"}],"objects":{"dataPoint":{"displayName":"Scrollyteller options","properties":{"fontColor":{"displayName":"Text color","type":{"fill":{"solid":{"color":true}}}},"fontSize":{"displayName":"Text size","type":{"formatting":{"fontSize":true}}},"fontFamily":{"displayName":"Font family","type":{"enumeration":[{"value":"Arial","displayName":"Arial"},{"value":"Arial Black","displayName":"Arial Black"},{"value":"Arial Unicode MS","displayName":"Arial Unicode MS"},{"value":"Bookman Old Style","displayName":"Bookman Old Style"},{"value":"Calibri","displayName":"Calibri"},{"value":"Cambria","displayName":"Cambria"},{"value":"Candara","displayName":"Candara"},{"value":"Castellar","displayName":"Castellar"},{"value":"Comic Sans MS","displayName":"Comic Sans MS"},{"value":"Consolas","displayName":"Consolas"},{"value":"Constantia","displayName":"Constantia"},{"value":"Corbel","displayName":"Corbel"},{"value":"Courier New","displayName":"Courier New"},{"value":"Georgia","displayName":"Georgia"},{"value":"Impact","displayName":"Impact"},{"value":"Lucida Calligraphy","displayName":"Lucida Calligraphy"},{"value":"Lucida Sans Unicode","displayName":"Lucida Sans Unicode"},{"value":"Segoe UI","displayName":"Segoe UI"},{"value":"Segoe UI Light","displayName":"Segoe UI Light"},{"value":"Symbol","displayName":"Symbol"},{"value":"Tahoma","displayName":"Tahoma"},{"value":"Times New Roman","displayName":"Times New Roman"},{"value":"Trebuchet MS","displayName":"Trebuchet MS"},{"value":"Verdana","displayName":"Verdana"}]}},"fontWeight":{"displayName":"Font weight","type":{"enumeration":[{"value":"Normal","displayName":"Normal"},{"value":"Bold","displayName":"Bold"}]}},"textAlign":{"displayName":"Text align","type":{"enumeration":[{"value":"Center","displayName":"Center"},{"value":"Left","displayName":"Left"},{"value":"Right","displayName":"Right"}]}},"wordWrap":{"displayName":"Word wrap","type":{"enumeration":[{"value":"normal","displayName":"Normal"},{"value":"break-word","displayName":"Break word"}]}}}}},"dataViewMappings":[{"conditions":[{"category":{"min":1,"max":1},"measure":{"max":1},"imageUrl":{"min":0,"max":1}}],"categorical":{"categories":{"select":[{"for":{"in":"category"}},{"bind":{"to":"imageUrl"}}],"dataReductionAlgorithm":{"top":{"count":30000}}}}}],"sorting":{"implicit":{"clauses":[{"role":"measure","direction":1},{"role":"category","direction":1}]}}},"stringResources":{},"content":{"js":"var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e,t,i){void 0===e&&(e=[]);var n=e;return r(n),t&&(n.identityFields=t),i&&(n.source=i),n}function r(e,t){e.grouped=t?function(){return t}:function(){return i(e)}}function i(e){for(var t,r=[],i=0,n=e.length;n>i;i++){var a=e[i];if(!t||t.identity!==a.identity){if(t={values:[]},a.identity){t.identity=a.identity;var o=a.source;void 0!==o.groupName?t.name=o.groupName:o.displayName&&(t.name=o.displayName)}r.push(t)}t.values.push(a)}return r}e.createValueColumns=t,e.setGrouped=r,e.groupValues=i}(t=e.DataViewTransform||(e.DataViewTransform={}))}(t=e.dataview||(e.dataview={}))}(t=e.utils||(e.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e,t){if(!e||!e.length)return-1;var r=e[0];if(r.values&&r.values.length>0)for(var n=0,a=r.values.length;a>n;++n){var o=r.values[n];if(o&&o.source&&i(o.source,t))return n}return-1}function r(e,t){if(e&&e.length)for(var r=0,n=e.length;n>r;r++)if(i(e[r].source,t))return r;return-1}function i(e,t){var r=e.roles;return r&&r[t]}function n(e,t){return null!=e&&null!=e.metadata&&e.metadata.columns&&e.metadata.columns.some(function(e){return e.roles&&void 0!==e.roles[t]})}function a(e,t){return e&&e.source&&e.source.roles&&e.source.roles[t]===!0}e.getMeasureIndexOfRole=t,e.getCategoryIndexOfRole=r,e.hasRole=i,e.hasRoleInDataView=n,e.hasRoleInValueColumn=a}(t=e.DataRoleHelper||(e.DataRoleHelper={}))}(t=e.dataview||(e.dataview={}))}(t=e.utils||(e.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e,t,r){if(!e)return r;var i=e[t];return void 0===i?r:i}function r(e,r,i){var n=t(e,r);return n&&n.solid?n.solid.color:i}e.getValue=t,e.getFillColorByPropertyName=r}(t=e.DataViewObject||(e.DataViewObject={}))}(t=e.dataview||(e.dataview={}))}(t=e.utils||(e.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){function r(t,r,i){return t?e.DataViewObject.getValue(t[r.objectName],r.propertyName,i):i}function i(e,t,r){return e&&e[t]?e[t]:r}function n(e,t,i){var n=r(e,t);return n&&n.solid?n.solid.color:i}function a(e,t,i){var n=r(e,t,i);return n&&n.solid?n.solid.color:void 0===n||null===n||\"object\"==typeof n&&!n.solid?i:n}t.getValue=r,t.getObject=i,t.getFillColor=n,t.getCommonValue=a}(t=e.DataViewObjects||(e.DataViewObjects={}))}(t=e.dataview||(e.dataview={}))}(t=e.utils||(e.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(t){var r;!function(t){var r,i=e.extensibility.utils.dataview.DataRoleHelper;!function(e){function t(e,t,r){if(e.categories&&e.categories.length>0){var n=e.categories[0];return n.source&&i.hasRole(n.source,t)&&i.hasRole(n.source,r)}return!1}function r(e){return void 0!==e.groupName?e.groupName:e.queryName}function n(e){var t=o(e);return null!=t&&t.imageUrl===!0}function a(e){var t=o(e);return null!=t&&t.webUrl===!0}function o(e){return e&&e.type&&e.type.misc}function s(e){return e&&e.metadata&&e.metadata.columns&&e.metadata.columns.length?e.metadata.columns.some(function(e){return n(e)===!0}):!1}e.categoryIsAlsoSeriesRole=t,e.getSeriesName=r,e.isImageUrlColumn=n,e.isWebUrlColumn=a,e.getMiscellaneousTypeDescriptor=o,e.hasImageUrlColumn=s}(r=t.converterHelper||(t.converterHelper={}))}(r=t.dataview||(t.dataview={}))}(r=t.utils||(t.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function t(){}return t.getDefault=function(){return new this},t.createPropertyIdentifier=function(e,t){return{objectName:e,propertyName:t}},t.parse=function(t){var r,i=this.getDefault();if(!t||!t.metadata||!t.metadata.objects)return i;r=i.getProperties();for(var n in r)for(var a in r[n]){var o=i[n][a];i[n][a]=e.DataViewObjects.getCommonValue(t.metadata.objects,r[n][a],o)}return i},t.isPropertyEnumerable=function(e){return!t.InnumerablePropertyPrefix.test(e)},t.enumerateObjectInstances=function(e,t){var r=e&&e[t.objectName];if(!r)return[];var i={objectName:t.objectName,selector:null,properties:{}};for(var n in r)r.hasOwnProperty(n)&&(i.properties[n]=r[n]);return{instances:[i]}},t.prototype.getProperties=function(){var e=this,r={},i=Object.keys(this);return i.forEach(function(i){if(t.isPropertyEnumerable(i)){var n=Object.keys(e[i]);r[i]={},n.forEach(function(e){t.isPropertyEnumerable(i)&&(r[i][e]=t.createPropertyIdentifier(i,e))})}}),r},t}();t.InnumerablePropertyPrefix=/^_/,e.DataViewObjectsParser=t}(t=e.dataview||(e.dataview={}))}(t=e.utils||(e.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},powerbi;!function(e){var t;!function(t){var r;!function(t){var r;!function(t){\"use strict\";var r=e.extensibility.utils.dataview.DataViewObjectsParser,i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dataPoint=new n,t}return __extends(t,e),t}(r);t.VisualSettings=i;var n=function(){function e(){this.fontColor=\"#FFFFFF\",this.fontSize=12,this.fontFamily=\"Segoe UI\",this.fontWeight=\"Normal\",this.textAlign=\"Center\",this.wordWrap=\"normal\"}return e}();t.dataPointSettings=n}(r=t.scrollytellerE1D30D6506E94BB5AB73806C9D68D079||(t.scrollytellerE1D30D6506E94BB5AB73806C9D68D079={}))}(r=t.visual||(t.visual={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(t){var r;!function(t){\"use strict\";function r(e,t){var r=e.dataViews,n={scrollyDataPoints:[]};if(!(r&&r[0]&&r[0].categorical&&r[0].categorical.categories&&r[0].categorical.categories[0].source))return n;for(var a=r[0].categorical,o=i.getCategoryIndexOfRole(r[0].categorical.categories,\"category\"),s=i.getCategoryIndexOfRole(r[0].categorical.categories,\"imageUrl\"),l=a.categories[o],u=a.categories[s],c=[],f=0;f<l.values.length;f++)c.push({scrollText:-1===o?\"Add field to Text -->\":l.values[f].toString(),imageUrl:-1===s?\"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTh9NPZZrS45zHvMPX-moeDysqUZ4Mnx5xnMA-8Iqx_wXjYteCkLg\":u.values[f].toString()});return{scrollyDataPoints:c}}var i=e.extensibility.utils.dataview.DataRoleHelper,n=function(){function e(e){this.target=e.element,this.target.innerHTML='<div class=\"wrapper\" id=\"loader\"></div>'}return e.prototype.update=function(t){this.settings=e.parseSettings(t&&t.dataViews&&t.dataViews[0]);for(var i=this.settings.dataPoint.fontSize.toString()+\"px\",n=this.settings.dataPoint.fontColor,a=this.settings.dataPoint.fontFamily,o=this.settings.dataPoint.fontWeight,s=this.settings.dataPoint.textAlign,l=this.settings.dataPoint.wordWrap,u=r(t,this.host),c=u.scrollyDataPoints,f=document.getElementById(\"loader\");f.firstChild;)f.removeChild(f.firstChild);for(var v=0;v<c.length;v++){var d=document.createElement(\"section\");d.classList.add(\"img-\"+v),d.classList.add(\"section\"),d.classList.add(\"parallax\"),d.style.backgroundImage=\"url('\"+c[v].imageUrl+\"')\",d.style.backgroundRepeat=\"no-repeat\",d.style.backgroundSize=\"100%\",d.style.transform=\"translateZ(-1px) scale(1.5)\";var p=document.createElement(\"section\");p.classList.add(\"story\"),p.style.backgroundImage=\"url('\"+c[v].imageUrl+\"')\",p.style.backgroundRepeat=\"no-repeat\",p.style.backgroundSize=\"50vh\",p.style.backgroundPosition=\"left\";var g=document.createElement(\"div\");g.classList.add(\"text-pane\"),f.appendChild(d),f.appendChild(p);var y=document.createElement(\"h1\");y.innerHTML=c[v].scrollText,y.classList.add(\"scrollyText\"),y.style.color=n,y.style.fontSize=i,y.style.fontFamily=a,y.style.fontWeight=o,y.style.textAlign=s,y.style.wordWrap=l,g.appendChild(y),p.appendChild(g)}},e.parseSettings=function(e){return t.VisualSettings.parse(e)},e.prototype.enumerateObjectInstances=function(e){return t.VisualSettings.enumerateObjectInstances(this.settings||t.VisualSettings.getDefault(),e)},e}();t.Visual=n}(r=t.scrollytellerE1D30D6506E94BB5AB73806C9D68D079||(t.scrollytellerE1D30D6506E94BB5AB73806C9D68D079={}))}(r=t.visual||(t.visual={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(t){t.scrollytellerE1D30D6506E94BB5AB73806C9D68D079={name:\"scrollytellerE1D30D6506E94BB5AB73806C9D68D079\",displayName:\"ScrollyTeller\",\"class\":\"Visual\",version:\"1.0.2\",apiVersion:\"1.7.0\",create:function(t){return new e.extensibility.visual.scrollytellerE1D30D6506E94BB5AB73806C9D68D079.Visual(t)},custom:!0}}(r=t.plugins||(t.plugins={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));","css":".visual-scrollytellerE1D30D6506E94BB5AB73806C9D68D079 body,.visual-scrollytellerE1D30D6506E94BB5AB73806C9D68D079 html{margin:0;padding:0}.visual-scrollytellerE1D30D6506E94BB5AB73806C9D68D079 .wrapper{height:100vh;overflow-x:hidden;overflow-y:auto;perspective:2px}.visual-scrollytellerE1D30D6506E94BB5AB73806C9D68D079 .section{position:relative;width:100%;height:100vh;display:flex;align-items:center;justify-content:center;text-shadow:0 0 3px #222222;-webkit-filter:grayscale(100%);filter:gray}.visual-scrollytellerE1D30D6506E94BB5AB73806C9D68D079 .story{position:relative;height:50vh;width:100%;background:#000000;display:fixed;align-items:center;justify-content:center;text-shadow:0 0 3px #222222;z-index:1}.visual-scrollytellerE1D30D6506E94BB5AB73806C9D68D079 .textPane{position:relative;height:50vh;width:55%;background:#000000;display:fixed;align-items:center;justify-content:center;text-shadow:0 0 3px #222222;z-index:1}.visual-scrollytellerE1D30D6506E94BB5AB73806C9D68D079 .parallax::after{content:\" \";position:absolute;vertical-align:middle;top:0;right:0;bottom:0;left:0;transform:translateZ(-1px) scale(1.5);z-index:-1}.visual-scrollytellerE1D30D6506E94BB5AB73806C9D68D079 .scrollyText{padding-left:50%;padding-right:25px;word-wrap:break-word}","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTczbp9jAAABrklEQVQ4T+2Uz0vCYBjHF3To1KFb9GMILn9PLxH0R6iHPAnhqa79Bf0R3eZB9CDqTiIGiT8QBhP04CEQjxIDi/Lglpq1Wc/mM0tnZnUK+sL3MN7n+bzf9932EKhVi8Vy6HK5Ln0+Xz8cDsuf2e/3iw6Hg4Habew1yul00sFg8Dqbzd73Qa8LlE6nOwBTwBxN0weImBbseByLxRaCdPE8LwBIQVegdx8x74KEp5FI5Al7Fqrdbne9Xq8MsBGkfIHeK4/HQyFqLLfbvTRQVaFQGAJUTahBIeWF2WxeR9z3EuqSJKnXaDRauVzuLhAI3AB0B3FGYL1eH+Tz+REkmZjjuGdcNiiRSEg2m41E3M8SftQfBM6+5Wq1OiyVSkqxWJxrda1Wq03q/+/QeIflcllOpVIKwzDyPLMsK6s1WL5cQlEUH5vNZmue1TUs02QAwv948psjJ5NJyW637yJOAx7F4/GpXZeVIAhddZZardZNxBEERVFboVCIj0ajA3XIwnd2C9/bxLPPujOZzANM+C7AzkiSXEOcphWTybQH44gF98D6AP3KHbj/czjuxhhDEG+qRTZc7C0QUQAAAABJRU5ErkJggg=="}}